<link rel="stylesheet" href="{{ url_for('static', filename='iconfont/tabler-icons.min.css') }}"> <!-- Tabler Icons -->
<link rel="stylesheet" href="{{ url_for('static', filename='main.css') }}"/> <!-- Tailwind -->
<link rel="stylesheet" href="https://rsms.me/inter/inter.css"> <!-- Font -->
<script src="{{ url_for('static', filename='htmx.min.js') }}" ></script> <!-- htmx -->
<script src="{{ url_for('static', filename='_hyperscript_w9y.min.js') }}"></script> <!-- hyperscript -->
<script type="text/hyperscript">
behavior DropdownBehaviour(button, content)
  set :shown to false
  init add .invisible to content end
  on click from button in me
    if not :shown
      trigger showContent
    end
  end
  on click from document
    if :shown and no event.target in (content in me)
      trigger hideContent
    end
  end
  on showContent
    remove .invisible from content in me
    settle then set :shown to true
  end
  on hideContent
    settle then set :shown to false
    add .invisible to content in me
  end
end

behavior TransitionAutoHeightBehaviour
    on showElem
        measure my scrollHeight
        set my style's height to `${scrollHeight}px`
    on hideElem
        set my style's height to 0px

behavior TableSearchBehaviour
    set :tbody to <tbody/> in me
    set :rows to <tr/> in :tbody
    on search(matches, column)
        for row in :rows
            set details to <td/> in row
            set terms to []
            if column[0] is 'c'
                repeat in column
                    if it is 'c' continue end
                    append details[it as Int].innerHTML to terms
                end
            else
                append details[column as Int].innerHTML to terms
            end
            set hasMatch to false
            for match in matches
                for term in terms
                    if term.toUpperCase().includes(match.toUpperCase())
                        set hasMatch to true
                        break
                    end
                end
                if hasMatch break end
            end
            if hasMatch show row else hide row end
        end
    end

behavior TableCheckboxBehaviour
    set :check_all to first <input[name='check_all']/> in <thead/> in me
    set :check_body to <input[type='checkbox']/> in <tbody/> in me
    init
        make Map then set :values to it
    end
    on change(target) queue all
        if target is :check_all
            repeat for el in :check_body
                set el.checked to target.checked
                make Event from 'change', {'bubbles': true} called event
                call el.dispatchEvent(event)
            end
        else
            if target.checked
                call :values.set(target, target.value)
            else
                call :values.delete(target)
            end
            set is_all_checked to (length of :check_body) is (size of :values)
            set checked of :check_all to is_all_checked
            trigger selectValues(values: Array.from(:values.values()))
        end
</script>

